function obj_mask_alignment(F,M,opts)
    if nargin<3;                        opts                 = struct();     end
    if ~isfield(opts,'PSF_size');       opts.psf_size        = 5;            end
    if ~isfield(opts,'PSF_sigma');      opts.psf_sigma       = 5;            end
    if ~isfield(opts,'opening_mask');   opts.opening_mask    = [1;1];        end
    
    PSF = fspecial('gaussian', [opts.psf_size opts.psf_size], opts.psf_sigma);
    I_trans_F = mat2gray(F);
    I_trans_F = imdiffusefilt(I_trans_F); % Not sure about this step
    I_decon_F = deconvlucy(I_trans_F, PSF, 10);
    
    level_F = otsuthresh(imhist(I_decon_F));
    I_thresh_F = imbinarize(I_decon_F, level_F);
    
    I_eroded_F = imopen(I_thresh_F, opts.opening_mask);
    
    I_trans_M = mat2gray(M);
    I_trans_M = imdiffusefilt(I_trans_M); % Not sure about this step
    I_decon_M = deconvlucy(I_trans_M, PSF, 10);
    
    level_M = otsuthresh(imhist(I_decon_M));
    I_thresh_M = imbinarize(I_decon_M, level_M);
    
    I_eroded_M = imopen(I_thresh_M, opts.opening_mask);
    
    [optimizer,metric] = imregconfig('multimodal');
    movingRegisteredDefault = imregister(moving,fixed,'affine',optimizer,metric);
    
    
    
end